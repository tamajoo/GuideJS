!function(e){e.widget("ui.guide",{version:"1",options:{autostart:!1,locale:"",classes:{btnContainer:"",nextBtn:"",prevBtn:"",focusContainer:"",infoContainer:"",stepText:""},delay:300},regional:{default:{next:"Next",prev:"Back",pause:"Pause",close:"Close",continue:"Continue"}},$overlay:null,$ghost:null,$btnWrap:null,$nextBtn:null,$prevBtn:null,$stepElem:null,$textElem:null,step:0,_destroy:function(){var t=this;t._clear(),t.$overlay.remove(),t.options=null},_create:function(){},_init:function(){this.options=e.extend(!0,this.options,this.element.data()),this._setLocale(),this._initOverlay(),this._initButtons(),this._on(e(document),{keyup:function(t){switch(t.which){case 27:this.stop();break;case 13:this.next()}}}),this.options.autostart&&this.start()},_isDefined:function(t){return void 0!==t},_getText:function(t){return this._isDefined(this.regional[this.locale])&&this._isDefined(this.regional[this.locale][t])?this.regional[this.locale][t]:this.regional.default[t]},_setLocale:function(){if(!this.options.locale){var t=e(document).attr("lang");this._isDefined(t)&&(this.options.locale=t)}},_initOverlay:function(){this.$overlay=e('<div class="gjs-ov">'),this._on(this.$overlay,{click:this.stop}),this.element.append(this.$overlay),this.$ghost=e('<div class="gjs-ghost">'),this.$overlay.append(this.$ghost)},_initButtons:function(){this.$nextBtn=e('<button class="gjs-btn gjs-btn-n '+this.options.classes.nextBtn+'">'+this._getText("next")+"</button>"),this.$prevBtn=e('<button class="gjs-btn gjs-btn-p '+this.options.classes.prevBtn+'">'+this._getText("prev")+"</button>"),this._on(this.$nextBtn,{click:this.next}),this._on(this.$prevBtn,{click:this.prev}),this.$btnWrap=e('<div class="'+this.options.classes.btnContainer+' gjs-btns">'),this.$btnWrap.append(this.$prevBtn,this.$nextBtn)},_showOverlay:function(){this.$overlay.addClass("gjs-open")},_hideOverlay:function(){this.$overlay.removeClass("gjs-open")},_detachButtons:function(){this.$btnWrap.detach()},_clear:function(){this.$textElem&&(this.$textElem.remove(),this.$textElem=null),this._detachButtons(),this.element.find(".gjs-foc > [data-guidejs]").unwrap()},_wrapElem:function(){var t=e('<div class="gjs-foc '+this.options.classes.focusContainer+'"></div>');this.$stepElem.is("[data-guidejs-outline]")&&t.addClass("gjs-ol"),this.$stepElem.data("guidejs-background")&&t.css({backgroundColor:this.$stepElem.data("guidejs-background"),outlineColor:this.$stepElem.data("guidejs-background")}),this.$stepElem.wrap(t),this._showButtons(),this._showText()},_showStep:function(){if(this._clear(),this.$stepElem=this.element.find('[data-guidejs="'+this.step+'"]').first(),!this.$stepElem.length)return this.stop();this._updateGhost();var t=this;setTimeout(function(){t._wrapElem()},this.options.delay)},_updateGhost:function(){var t=this.$stepElem.offset(),s=e(window).scrollTop();t.top=t.top-s,t.width=this.$stepElem.width(),t.height=this.$stepElem.height(),this.$ghost.css(t)},_showButtons:function(){$wrap=this.$stepElem.parent(),$wrap.append(this.$btnWrap)},_showText:function(){$wrap=this.$stepElem.parent(),this.$stepElem.data("guidejs-text")&&(this.$textElem=e('<div class="gjs-txt '+this.options.classes.stepText+'"></div>'),this.$textElem.html(this.$stepElem.data("guidejs-text")),$wrap.append(this.$textElem))},_prevent:function(t){this._isDefined(t)&&"function"==typeof t.preventDefault&&t.preventDefault()},start:function(t){this._prevent(t),this.step=0,this.next(),this._showOverlay()},stop:function(t){this._prevent(t),this._clear(),this._hideOverlay()},continue:function(t){this._prevent(t),this._showOverlay()},next:function(t){this._prevent(t),this.step++,this._showStep()},prev:function(t){this._prevent(t),this.step--,this._showStep()}})}(jQuery);